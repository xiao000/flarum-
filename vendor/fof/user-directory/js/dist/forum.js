module.exports=function(e){var t={};function r(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(o,s,function(t){return e[t]}.bind(null,s));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=19)}([function(e,t){e.exports=flarum.core.compat.app},function(e,t){e.exports=flarum.core.compat.extend},function(e,t){e.exports=flarum.core.compat["components/IndexPage"]},function(e,t){e.exports=flarum.core.compat["components/LinkButton"]},function(e,t){e.exports=flarum.core.compat["components/Button"]},function(e,t){e.exports=flarum.core.compat.Component},function(e,t){e.exports=flarum.core.compat["helpers/listItems"]},function(e,t){e.exports=flarum.core.compat["utils/ItemList"]},,function(e,t){e.exports=flarum.core.compat["components/UsersSearchSource"]},function(e,t){e.exports=flarum.core.compat["components/Page"]},function(e,t){e.exports=flarum.core.compat["components/DiscussionComposer"]},function(e,t){e.exports=flarum.core.compat["components/LogInModal"]},function(e,t){e.exports=flarum.core.compat["components/Select"]},function(e,t){e.exports=flarum.core.compat["components/SelectDropdown"]},function(e,t){e.exports=flarum.core.compat["components/LoadingIndicator"]},function(e,t){e.exports=flarum.core.compat["components/Placeholder"]},function(e,t){e.exports=flarum.core.compat["components/UserCard"]},,function(e,t,r){"use strict";r.r(t),r.d(t,"UserDirectoryPage",(function(){return z}));var o=r(1),s=r(0),n=r.n(s),a=r(9),i=r.n(a),c=r(3),u=r.n(c),p=r(2),f=r.n(p);function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var d=r(10),h=r.n(d),y=r(7),v=r.n(y),g=r(6),x=r.n(g),b=r(11),w=r.n(b),_=r(12),N=r.n(_),D=r(13),I=r.n(D),U=r(4),P=r.n(U),L=r(14),j=r.n(L),O=r(5),k=r.n(O),S=r(15),C=r.n(S),q=r(16),M=r.n(q),A=r(17),B=r.n(A),R=function(e){function t(){return e.apply(this,arguments)||this}return l(t,e),t.prototype.view=function(){var e=this.props.user,t=B.a.component({user:e,className:"UserCard--directory",controlsButtonClassName:"Button Button--icon Button--flat"});return m("div",{className:"User"},t)},t}(k.a),T=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var r=t.prototype;return r.init=function(){this.loading=!0,this.moreResults=!1,this.users=[],this.refresh()},r.view=function(){var e,t=this.props.params;if(this.loading?e=C.a.component():this.moreResults&&(e=P.a.component({children:n.a.translator.trans("core.forum.discussion_list.load_more_button"),className:"Button",onclick:this.loadMore.bind(this)})),0===this.users.length&&!this.loading){var r=n.a.translator.trans("core.forum.discussion_list.empty_text");return m("div",{className:"DiscussionList"},M.a.component({text:r}))}return m("div",{className:"UserDirectoryList"},this.users.map((function(e){return m("div",{key:e.username(),"data-id":e.username()},R.component({user:e,params:t}))})),m("div",{key:"load-more",className:"UserDirectoryList-loadMore"},e))},r.requestParams=function(){var e={include:[],filter:{}};return e.sort=this.sortMap()[this.props.params.sort],this.props.params.q&&(e.filter.q=this.props.params.q),e},r.sortMap=function(){var e={};return this.props.params.q?e.relevance="":e.default="",e.username_az="username",e.username_za="-username",e.newest="-joinedAt",e.oldest="joinedAt",e.seen_recent="-lastSeenAt",e.seen_oldest="lastSeenAt",e.most_discussions="-discussionCount",e.least_discussions="discussionCount",e},r.refresh=function(e){var t=this;return void 0===e&&(e=!0),e&&(this.loading=!0,this.users=[]),this.loadResults(0).then((function(e){t.users=[],t.parseResults(e)}),(function(){t.loading=!1,m.redraw()}))},r.loadResults=function(e){var t=n.a.preloadedApiDocument();if(t)return m.deferred().resolve(t).promise;var r=this.requestParams();return r.page={offset:e},r.include=r.include.join(","),n.a.store.find("users",r)},r.loadMore=function(){this.loading=!0,this.loadResults(this.users.length).then(this.parseResults.bind(this))},r.parseResults=function(e){return[].push.apply(this.users,e),this.loading=!1,this.moreResults=!!e.payload.links.next,m.lazyRedraw(),e},r.removeUser=function(e){var t=this.users.indexOf(e);-1!==t&&this.users.splice(t,1)},r.addUser=function(e){this.users.unshift(e)},t}(k.a),z=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var r=t.prototype;return r.init=function(){e.prototype.init.call(this),n.a.previous instanceof t&&(n.a.cache.fofUserDirectoryList=null);var r=this.params();n.a.cache.fofUserDirectoryList&&Object.keys(r).some((function(e){if(n.a.cache.fofUserDirectoryList.props.params[e]!==r[e])return n.a.cache.fofUserDirectoryList=null,!0})),n.a.cache.fofUserDirectoryList||(n.a.cache.fofUserDirectoryList=new T({params:r})),this.bodyClass="User--directory"},r.onunload=function(){n.a.cache.scrollTop=$(window).scrollTop()},r.view=function(){return m("div",{className:"IndexPage"},f.a.prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,x()(this.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("div",{className:"IndexPage-toolbar"},m("ul",{className:"IndexPage-toolbar-view"},x()(this.viewItems().toArray())),m("ul",{className:"IndexPage-toolbar-action"},x()(this.actionItems().toArray()))),n.a.cache.fofUserDirectoryList.render()))))},r.config=function(t,r){if(e.prototype.config.apply(this,arguments),!t){Object(o.extend)(r,"onunload",(function(){return $("#app").css("min-height","")})),n.a.setTitle(""),n.a.setTitleCount(0);var s=n.a.cache.scrollTop;$("#app").css("min-height",$(window).height());var a=function(){return $(window).scrollTop(s)};a(),setTimeout(a,1)}},r.sidebarItems=function(){var e=f.a.prototype.sidebarItems();return e.replace("nav",j.a.component({children:this.navItems(this).toArray(),buttonClassName:"Button",className:"App-titleControl"})),e},r.navItems=function(){var e=f.a.prototype.navItems(),t=this.stickyParams();return e.add("fof-user-directory",u.a.component({href:n.a.route("fof_user_directory",t),children:n.a.translator.trans("fof-user-directory.forum.page.nav"),icon:"far fa-address-book"}),85),e},r.viewItems=function(){var e=new v.a,t=n.a.cache.fofUserDirectoryList.sortMap(),r={};for(var o in t)r[o]=n.a.translator.trans("fof-user-directory.forum.page.sort."+o);return e.add("sort",I.a.component({options:r,value:this.params().sort||Object.keys(t)[0],onchange:this.changeSort.bind(this)})),e},r.actionItems=function(){var e=new v.a;return e.add("refresh",P.a.component({title:n.a.translator.trans("core.forum.index.refresh_tooltip"),icon:"fas fa-sync",className:"Button Button--icon",onclick:function(){n.a.cache.fofUserDirectoryList.refresh(),n.a.session.user&&(n.a.store.find("users",n.a.session.user.id()),m.redraw())}})),e},r.searching=function(){return this.params().q},r.clearSearch=function(){var e=this.params();delete e.q,m.route(n.a.route(this.props.routeName,e))},r.changeSort=function(e){var t=this.params();e===Object.keys(n.a.cache.fofUserDirectoryList.sortMap())[0]?delete t.sort:t.sort=e,m.route(n.a.route(this.props.routeName,t))},r.stickyParams=function(){return{sort:m.route.param("sort"),q:m.route.param("q")}},r.params=function(){var e=this.stickyParams();return e.filter=m.route.param("filter"),e},r.newDiscussion=function(){var e=m.deferred();return n.a.session.user?this.composeNewDiscussion(e):n.a.modal.show(new N.a({onlogin:this.composeNewDiscussion.bind(this,e)})),e.promise},r.composeNewDiscussion=function(e){var t=new w.a({user:n.a.session.user});return n.a.composer.load(t),n.a.composer.show(),e.resolve(t),e.promise},t}(h.a);n.a.initializers.add("fof-user-directory",(function(e){e.routes.fof_user_directory={path:"/users",component:z.component()},Object(o.extend)(i.a.prototype,"view",(function(t,r){t&&(r=r.toLowerCase(),t.splice(1,0,m("li",null,u.a.component({icon:"fas fa-search",children:e.translator.trans("fof-user-directory.forum.search.users_heading",{query:r}),href:e.route("fof_user_directory",{q:r})}))))})),Object(o.extend)(f.a.prototype,"navItems",(function(t){e.forum.attribute("canSeeUserDirectoryLink")&&t.add("fof-user-directory",u.a.component({href:e.route("fof_user_directory"),children:e.translator.trans("fof-user-directory.forum.page.nav"),icon:"far fa-address-book"}),85)}))}))}]);
//# sourceMappingURL=forum.js.map